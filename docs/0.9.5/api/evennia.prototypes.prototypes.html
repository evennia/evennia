
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>evennia.prototypes.prototypes &#8212; Evennia 0.9.5 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Evennia 0.9.5</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.prototypes.prototypes</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="module-evennia.prototypes.prototypes">
<span id="evennia-prototypes-prototypes"></span><h1>evennia.prototypes.prototypes<a class="headerlink" href="#module-evennia.prototypes.prototypes" title="Permalink to this headline">¶</a></h1>
<p>Handling storage of prototypes, both database-based ones (DBPrototypes) and those defined in modules
(Read-only prototypes). Also contains utility functions, formatters and manager functions.</p>
<dl class="py exception">
<dt id="evennia.prototypes.prototypes.PermissionError">
<em class="property">exception </em><code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">PermissionError</code><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PermissionError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PermissionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt id="evennia.prototypes.prototypes.ValidationError">
<em class="property">exception </em><code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">ValidationError</code><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#ValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.ValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
<p>Raised on prototype validation errors</p>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.homogenize_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">homogenize_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype</span></em>, <em class="sig-param"><span class="n">custom_keys</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#homogenize_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.homogenize_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Homogenize the more free-form prototype supported pre Evennia 0.7 into the stricter form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prototype</strong> (<em>dict</em>) – Prototype.</p></li>
<li><p><strong>custom_keys</strong> (<em>list</em><em>, </em><em>optional</em>) – Custom keys which should not be interpreted as attrs, beyond
the default reserved keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>homogenized (dict)</em> –</p>
<dl class="simple">
<dt>Prototype where all non-identified keys grouped as attributes and other</dt><dd><p>homogenizations like adding missing prototype_keys and setting a default typeclass.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.load_module_prototypes">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">load_module_prototypes</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">mod_or_prototypes</span></em>, <em class="sig-param"><span class="n">override</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#load_module_prototypes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.load_module_prototypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Load module prototypes. Also prototype-dicts passed directly to this function are considered
‘module’ prototypes (they are impossible to change) but will have a module of None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*mod_or_prototypes</strong> (<em>module</em><em> or </em><em>dict</em>) – Each arg should be a separate module or
prototype-dict to load. If none are given, <strong>settings.PROTOTYPE_MODULES</strong> will be used.</p></li>
<li><p><strong>override</strong> (<em>bool</em><em>, </em><em>optional</em>) – If prototypes should override existing ones already loaded.
Disabling this can allow for injecting prototypes into the system dynamically while
still allowing same prototype-keys to be overridden from settings (even though settings
is usually loaded before dynamic loading).</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is called (without arguments) by <strong>evennia.__init__</strong> as Evennia initializes. It’s
important to do this late so as to not interfere with evennia initialization. But it can
also be used later to add more prototypes to the library on the fly. This is requried
before a module-based prototype can be accessed by prototype-key.</p>
</div>
</dd></dl>

<dl class="py class">
<dt id="evennia.prototypes.prototypes.DbPrototype">
<em class="property">class </em><code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">DbPrototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#DbPrototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="evennia.scripts.scripts.html#evennia.scripts.scripts.DefaultScript" title="evennia.scripts.scripts.DefaultScript"><code class="xref py py-class docutils literal notranslate"><span class="pre">evennia.scripts.scripts.DefaultScript</span></code></a></p>
<p>This stores a single prototype, in an Attribute <strong>prototype</strong>.</p>
<dl class="py method">
<dt id="evennia.prototypes.prototypes.DbPrototype.at_script_creation">
<code class="sig-name descname">at_script_creation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#DbPrototype.at_script_creation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.at_script_creation" title="Permalink to this definition">¶</a></dt>
<dd><p>Only called once, when script is first created.</p>
</dd></dl>

<dl class="py method">
<dt id="evennia.prototypes.prototypes.DbPrototype.prototype">
<em class="property">property </em><code class="sig-name descname">prototype</code><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure to decouple from db!</p>
</dd></dl>

<dl class="py exception">
<dt id="evennia.prototypes.prototypes.DbPrototype.DoesNotExist">
<em class="property">exception </em><code class="sig-name descname">DoesNotExist</code><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.DoesNotExist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="evennia.scripts.scripts.html#evennia.scripts.scripts.DefaultScript.DoesNotExist" title="evennia.scripts.scripts.DefaultScript.DoesNotExist"><code class="xref py py-class docutils literal notranslate"><span class="pre">evennia.scripts.scripts.DefaultScript.DoesNotExist</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt id="evennia.prototypes.prototypes.DbPrototype.MultipleObjectsReturned">
<em class="property">exception </em><code class="sig-name descname">MultipleObjectsReturned</code><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.MultipleObjectsReturned" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="evennia.scripts.scripts.html#evennia.scripts.scripts.DefaultScript.MultipleObjectsReturned" title="evennia.scripts.scripts.DefaultScript.MultipleObjectsReturned"><code class="xref py py-class docutils literal notranslate"><span class="pre">evennia.scripts.scripts.DefaultScript.MultipleObjectsReturned</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="evennia.prototypes.prototypes.DbPrototype.path">
<code class="sig-name descname">path</code><em class="property"> = 'evennia.prototypes.prototypes.DbPrototype'</em><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="evennia.prototypes.prototypes.DbPrototype.typename">
<code class="sig-name descname">typename</code><em class="property"> = 'DbPrototype'</em><a class="headerlink" href="#evennia.prototypes.prototypes.DbPrototype.typename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.save_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">save_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#save_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.save_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Create/Store a prototype persistently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prototype</strong> (<em>dict</em>) – The prototype to save. A <strong>prototype_key</strong> key is
required.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>prototype (dict or None)</em> – The prototype stored using the given kwargs, None if deleting.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#evennia.prototypes.prototypes.ValidationError" title="evennia.prototypes.prototypes.ValidationError"><strong>prototypes.ValidationError</strong></a> – If prototype does not validate.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No edit/spawn locks will be checked here - if this function is called the caller
is expected to have valid permissions.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.create_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">create_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype</span></em><span class="sig-paren">)</span><a class="headerlink" href="#evennia.prototypes.prototypes.create_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Create/Store a prototype persistently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prototype</strong> (<em>dict</em>) – The prototype to save. A <strong>prototype_key</strong> key is
required.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>prototype (dict or None)</em> – The prototype stored using the given kwargs, None if deleting.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#evennia.prototypes.prototypes.ValidationError" title="evennia.prototypes.prototypes.ValidationError"><strong>prototypes.ValidationError</strong></a> – If prototype does not validate.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No edit/spawn locks will be checked here - if this function is called the caller
is expected to have valid permissions.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.delete_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">delete_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype_key</span></em>, <em class="sig-param"><span class="n">caller</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#delete_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.delete_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a stored prototype</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – The persistent prototype to delete.</p></li>
<li><p><strong>caller</strong> (<em>Account</em><em> or </em><em>Object</em><em>, </em><em>optionsl</em>) – Caller aiming to delete a prototype.
Note that no locks will be checked if**caller** is not passed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>success (bool)</em> – If deletion worked or not.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#evennia.prototypes.prototypes.PermissionError" title="evennia.prototypes.prototypes.PermissionError"><strong>PermissionError</strong></a> – If ‘edit’ lock was not passed or deletion failed for some other reason.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.search_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">search_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tags</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">require_single</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">return_iterators</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">no_db</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#search_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.search_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Find prototypes based on key and/or tags, or all prototypes.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – An exact or partial key to query for.</p></li>
<li><p><strong>tags</strong> (<em>str</em><em> or </em><a class="reference internal" href="evennia.contrib.barter.html#evennia.contrib.barter.TradeHandler.list" title="evennia.contrib.barter.TradeHandler.list"><em>list</em></a>) – Tag key or keys to query for. These
will always be applied with the ‘db_protototype’
tag category.</p></li>
<li><p><strong>require_single</strong> (<em>bool</em>) – If set, raise KeyError if the result
was not found or if there are multiple matches.</p></li>
<li><p><strong>return_iterators</strong> (<em>bool</em>) – Optimized return for large numbers of db-prototypes.
If set, separate returns of module based prototypes and paginate
the db-prototype return.</p></li>
<li><p><strong>no_db</strong> (<em>bool</em>) – Optimization. If set, skip querying for database-generated prototypes and only
include module-based prototypes. This can lead to a dramatic speedup since
module-prototypes are static and require no db-lookup.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><em>matches (list)</em> –</p>
<dl class="simple">
<dt>Default return, all found prototype dicts. Empty list if</dt><dd><p>no match was found. Note that if neither <strong>key</strong> nor <strong>tags</strong>
were given, <em>all</em> available prototypes will be returned.</p>
</dd>
<dt>list, queryset: If <strong>return_iterators</strong> are found, this is a list of</dt><dd><p>module-based prototypes followed by a <em>paginated</em> queryset of
db-prototypes.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>KeyError</strong> – If <strong>require_single</strong> is True and there are 0 or &gt;1 matches.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The available prototypes is a combination of those supplied in
PROTOTYPE_MODULES and those stored in the database. Note that if
tags are given and the prototype has no tags defined, it will not
be found as a match.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.search_objects_with_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">search_objects_with_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype_key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#search_objects_with_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.search_objects_with_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all object instances created by a given prototype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prototype_key</strong> (<em>str</em>) – The exact (and unique) prototype identifier to query for.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>matches (Queryset)</em> – All matching objects spawned from this prototype.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="evennia.prototypes.prototypes.PrototypeEvMore">
<em class="property">class </em><code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">PrototypeEvMore</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">caller</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PrototypeEvMore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PrototypeEvMore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="evennia.utils.evmore.html#evennia.utils.evmore.EvMore" title="evennia.utils.evmore.EvMore"><code class="xref py py-class docutils literal notranslate"><span class="pre">evennia.utils.evmore.EvMore</span></code></a></p>
<p>Listing 1000+ prototypes can be very slow. So we customize EvMore to
display an EvTable per paginated page rather than to try creating an
EvTable for the entire dataset and then paginate it.</p>
<dl class="py method">
<dt id="evennia.prototypes.prototypes.PrototypeEvMore.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">caller</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PrototypeEvMore.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PrototypeEvMore.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Store some extra properties on the EvMore class</p>
</dd></dl>

<dl class="py method">
<dt id="evennia.prototypes.prototypes.PrototypeEvMore.init_pages">
<code class="sig-name descname">init_pages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PrototypeEvMore.init_pages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PrototypeEvMore.init_pages" title="Permalink to this definition">¶</a></dt>
<dd><p>This will be initialized with a tuple (mod_prototype_list, paginated_db_query)
and we must handle these separately since they cannot be paginated in the same
way. We will build the prototypes so that the db-prototypes come first (they
are likely the most volatile), followed by the mod-prototypes.</p>
</dd></dl>

<dl class="py method">
<dt id="evennia.prototypes.prototypes.PrototypeEvMore.prototype_paginator">
<code class="sig-name descname">prototype_paginator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pageno</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PrototypeEvMore.prototype_paginator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PrototypeEvMore.prototype_paginator" title="Permalink to this definition">¶</a></dt>
<dd><p>The listing is separated in db/mod prototypes, so we need to figure out which
one to pick based on the page number. Also, pageno starts from 0.</p>
</dd></dl>

<dl class="py method">
<dt id="evennia.prototypes.prototypes.PrototypeEvMore.page_formatter">
<code class="sig-name descname">page_formatter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">page</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#PrototypeEvMore.page_formatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.PrototypeEvMore.page_formatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Input is a queryset page from django.Paginator</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.list_prototypes">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">list_prototypes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">caller</span></em>, <em class="sig-param"><span class="n">key</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tags</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_non_use</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_non_edit</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#list_prototypes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.list_prototypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Collate a list of found prototypes based on search criteria and access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>caller</strong> (<em>Account</em><em> or </em><em>Object</em>) – The object requesting the list.</p></li>
<li><p><strong>key</strong> (<em>str</em><em>, </em><em>optional</em>) – Exact or partial prototype key to query for.</p></li>
<li><p><strong>tags</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Tag key or keys to query for.</p></li>
<li><p><strong>show_non_use</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show also prototypes the caller may not use.</p></li>
<li><p><strong>show_non_edit</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show also prototypes the caller may not edit.</p></li>
<li><p><strong>session</strong> (<a class="reference internal" href="evennia.server.session.html#evennia.server.session.Session" title="evennia.server.session.Session"><em>Session</em></a><em>, </em><em>optional</em>) – If given, this is used for display formatting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>PrototypeEvMore</em> – An EvMore subclass optimized for prototype listings.
None: If no matches were found. In this case the caller has already been notified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.validate_prototype">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">validate_prototype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype</span></em>, <em class="sig-param"><span class="n">protkey</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">protparents</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_prototype_base</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">strict</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">_flags</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#validate_prototype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.validate_prototype" title="Permalink to this definition">¶</a></dt>
<dd><p>Run validation on a prototype, checking for inifinite regress.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prototype</strong> (<em>dict</em>) – Prototype to validate.</p></li>
<li><p><strong>protkey</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the prototype definition. If not given, the prototype
dict needs to have the <strong>prototype_key</strong> field set.</p></li>
<li><p><strong>protpartents</strong> (<em>dict</em><em>, </em><em>optional</em>) – The available prototype parent library. If
note given this will be determined from settings/database.</p></li>
<li><p><strong>is_prototype_base</strong> (<em>bool</em><em>, </em><em>optional</em>) – We are trying to create a new object <em>based on this
object</em>. This means we can’t allow ‘mixin’-style prototypes without typeclass/parent
etc.</p></li>
<li><p><strong>strict</strong> (<em>bool</em><em>, </em><em>optional</em>) – If unset, don’t require needed keys, only check against infinite
recursion etc.</p></li>
<li><p><strong>_flags</strong> (<em>dict</em><em>, </em><em>optional</em>) – Internal work dict that should not be set externally.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – If prototype has invalid structure.</p></li>
<li><p><strong>RuntimeWarning</strong> – If prototype has issues that would make it unsuitable to build an object
with (it may still be useful as a mix-in prototype).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.protfunc_parser">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">protfunc_parser</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">available_functions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">testing</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stacktrace</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">caller</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#protfunc_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.protfunc_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a prototype value string for a protfunc and process it.</p>
<p>Available protfuncs are specified as callables in one of the modules of
<strong>settings.PROTFUNC_MODULES</strong>, or specified on the command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>any</em>) – The value to test for a parseable protfunc. Only strings will be parsed for
protfuncs, all other types are returned as-is.</p></li>
<li><p><strong>available_functions</strong> (<em>dict</em><em>, </em><em>optional</em>) – Mapping of name:protfunction to use for this parsing.
If not set, use default sources.</p></li>
<li><p><strong>stacktrace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set, print the stack parsing process of the protfunc-parser.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>session</strong> (<a class="reference internal" href="evennia.server.session.html#evennia.server.session.Session" title="evennia.server.session.Session"><em>Session</em></a>) – Passed to protfunc. Session of the entity spawning the prototype.</p></li>
<li><p><strong>protototype</strong> (<em>dict</em>) – Passed to protfunc. The dict this protfunc is a part of.</p></li>
<li><p><strong>current_key</strong> (<em>str</em>) – Passed to protfunc. The key in the prototype that will hold this value.</p></li>
<li><p><strong>caller</strong> (<em>Object</em><em> or </em><em>Account</em>) – This is necessary for certain protfuncs that perform object
searches and have to check permissions.</p></li>
<li><p><strong>any</strong> (<em>any</em>) – Passed on to the protfunc.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><em>any</em> – A structure to replace the string on the prototype leve.  Note
that FunctionParser functions $funcname(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs) can return any
data type to insert into the prototype.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.format_available_protfuncs">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">format_available_protfuncs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#format_available_protfuncs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.format_available_protfuncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all protfuncs in a pretty-formatted form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clr</strong> (<em>str</em><em>, </em><em>optional</em>) – What coloration tag to use.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.prototype_to_str">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">prototype_to_str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#prototype_to_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.prototype_to_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a prototype to a nice string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prototype</strong> (<em>dict</em>) – The prototype.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.check_permission">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">check_permission</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prototype_key</span></em>, <em class="sig-param"><span class="n">action</span></em>, <em class="sig-param"><span class="n">default</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#check_permission"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.check_permission" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to check access to actions on given prototype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prototype_key</strong> (<em>str</em>) – The prototype to affect.</p></li>
<li><p><strong>action</strong> (<em>str</em>) – One of “spawn” or “edit”.</p></li>
<li><p><strong>default</strong> (<em>str</em>) – If action is unknown or prototype has no locks</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>passes (bool)</em> – If permission for action is granted or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.init_spawn_value">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">init_spawn_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">validator</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">caller</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prototype</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#init_spawn_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.init_spawn_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze the prototype value and produce a value useful at the point of spawning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<em>any</em>) – <p>This can be:
callable - will be called as callable()
(callable, (args,)) - will be called as callable(<a href="#id5"><span class="problematic" id="id6">*</span></a>args)
other - will be assigned depending on the variable type
validator (callable, optional): If given, this will be called with the value to</p>
<blockquote>
<div><p>check and guarantee the outcome is of a given type.</p>
</div></blockquote>
<dl class="simple">
<dt>caller (Object or Account): This is necessary for certain protfuncs that perform object</dt><dd><p>searches and have to check permissions.</p>
</dd>
</dl>
<p>prototype (dict): Prototype this is to be used for. Necessary for certain protfuncs.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>any (any)</em> – The (potentially pre-processed value to use for this prototype key)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.value_to_obj_or_any">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">value_to_obj_or_any</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#value_to_obj_or_any"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.value_to_obj_or_any" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert value(s) to Object if possible, otherwise keep original value</p>
</dd></dl>

<dl class="py function">
<dt id="evennia.prototypes.prototypes.value_to_obj">
<code class="sig-prename descclassname">evennia.prototypes.prototypes.</code><code class="sig-name descname">value_to_obj</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">force</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/evennia/prototypes/prototypes.html#value_to_obj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#evennia.prototypes.prototypes.value_to_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Always convert value(s) to Object, or None</p>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/evennia_logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <!--h3>This Page</h3-->
    <ul class="this-page-menu">
      <li><a href="../_sources/api/evennia.prototypes.prototypes.rst.txt"
            rel="nofollow">Show Page Source</a></li>
    </ul>
   </div><h3>Links</h3>
<ul>
  <li><a href="https://www.evennia.com">Home page</a> </li>
  <li><a href="https://github.com/evennia/evennia">Evennia Github</a> </li>
  <li><a href="http://games.evennia.com">Game Index</a> </li>
  <li>
    <a href="https://discord.gg/AJJpcRUhtF">Discord</a> -
     <a href="https://github.com/evennia/evennia/discussions">Discussions</a> -
      <a href="https://evennia.blogspot.com/">Blog</a>
  </li>
</ul>
<h3>Versions</h3>
<ul>
  <li><a href="../../1.0-dev/api/evennia.prototypes.prototypes.html">1.0-dev (develop branch)</a></li>
  <li><a href="evennia.prototypes.prototypes.html">0.9.5 (v0.9.5 branch)</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Evennia 0.9.5</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.prototypes.prototypes</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, The Evennia developer community.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>