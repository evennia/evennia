
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>evennia.contrib.evscaperoom.objects &#8212; Evennia 1.0-dev documentation</title>
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Evennia 1.0-dev</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../evennia.html" accesskey="U">evennia</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.contrib.evscaperoom.objects</a></li> 
      </ul>
        <div class="develop">develop branch</div>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for evennia.contrib.evscaperoom.objects</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Base objects for the Evscaperoom contrib.</span>


<span class="sd">The object class itself provide the actions possible to use on that object.</span>
<span class="sd">This makes these objects suitable for use with multi-inheritance. For example,</span>
<span class="sd">to make an object both possible to smell and eat or drink, find the appropriate</span>
<span class="sd">parents in this module and make an object like this:</span>

<span class="sd">class Apple(Edible, Smellable):</span>

<span class="sd">    def at_drink(self, caller):</span>
<span class="sd">        # ...</span>

<span class="sd">    def at_smell(self, caller):</span>
<span class="sd">        # ...</span>

<span class="sd">Various object parents could be more complex, so read the class for more info.</span>

<span class="sd">Available parents:</span>

<span class="sd">- EvscapeRoomObject - parent class for all Evscaperoom entities (also the room itself)</span>
<span class="sd">- Feelable</span>
<span class="sd">- Listenable</span>
<span class="sd">- Smellable</span>
<span class="sd">- Rotatable</span>
<span class="sd">- Openable</span>
<span class="sd">- Readable</span>
<span class="sd">- IndexReadable  (like a lexicon you have to give a search term in)</span>
<span class="sd">- Movable</span>
<span class="sd">- Edible</span>
<span class="sd">- Drinkable</span>
<span class="sd">- Usable</span>
<span class="sd">- Insertable  (can be inserted into a target)</span>
<span class="sd">- Combinable  (combines with another object to create a new one)</span>
<span class="sd">- Mixable     (used for mixing potions into it)</span>
<span class="sd">- HasButtons  (an object with buttons on it)</span>
<span class="sd">- CodeInput   (code locks)</span>
<span class="sd">- Sittable    (can be sat on)</span>
<span class="sd">- Liable      (can be lied down on)</span>
<span class="sd">- Kneeable    (can be kneed down on)</span>
<span class="sd">- Climbable   (can be climbed on)</span>
<span class="sd">- Positionable (supports sit/lie/knee/climb at once)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">evennia</span> <span class="kn">import</span> <span class="n">DefaultObject</span>
<span class="kn">from</span> <span class="nn">evennia.utils.utils</span> <span class="kn">import</span> <span class="n">list_to_string</span><span class="p">,</span> <span class="n">wrap</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">create_evscaperoom_object</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">parse_for_perspectives</span><span class="p">,</span> <span class="n">parse_for_things</span>


<div class="viewcode-block" id="EvscaperoomObject"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject">[docs]</a><span class="k">class</span> <span class="nc">EvscaperoomObject</span><span class="p">(</span><span class="n">DefaultObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Default object base for all objects related to the contrib.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># these will be automatically filtered out by self.parse for</span>
    <span class="c1"># focus-commands using arguments like (`combine [with] object`)</span>
    <span class="c1"># override this per-class as necessary.</span>
    <span class="n">action_prepositions</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">,</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s2">&quot;into&quot;</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">)</span>

    <span class="c1"># this mapping allows for prettier descriptions of our current</span>
    <span class="c1"># position</span>
    <span class="n">position_prep_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;sit&quot;</span><span class="p">:</span> <span class="s2">&quot;sitting&quot;</span><span class="p">,</span> <span class="s2">&quot;kneel&quot;</span><span class="p">:</span> <span class="s2">&quot;kneeling&quot;</span><span class="p">,</span> <span class="s2">&quot;lie&quot;</span><span class="p">:</span> <span class="s2">&quot;lying&quot;</span><span class="p">,</span> <span class="s2">&quot;climb&quot;</span><span class="p">:</span> <span class="s2">&quot;standing&quot;</span><span class="p">}</span>

<div class="viewcode-block" id="EvscaperoomObject.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called once when object is first created.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># state flags (setup/reset for each state).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">tagcategory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;Nothing of interest.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span></div>

    <span class="n">_tagcategory</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tagcategory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tagcategory</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tagcategory</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">tagcategory</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">tagcategory</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tagcategory</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">room</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="ow">or</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">roomstate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">statehandler</span><span class="o">.</span><span class="n">current_state</span>

<div class="viewcode-block" id="EvscaperoomObject.next_state"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.next_state">[docs]</a>    <span class="k">def</span> <span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">statename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper to have the object switch the room to next state</span>

<span class="sd">        Args:</span>
<span class="sd">            statename (str, optional): If given, move to this</span>
<span class="sd">                state next. Otherwise use the default next-state</span>
<span class="sd">                of the current state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">statehandler</span><span class="o">.</span><span class="n">next_state</span><span class="p">(</span><span class="n">next_state</span><span class="o">=</span><span class="n">statename</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.set_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.set_flag">[docs]</a>    <span class="k">def</span> <span class="nf">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">):</span>
        <span class="s2">&quot;Set flag on object&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">flagname</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="EvscaperoomObject.unset_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.unset_flag">[docs]</a>    <span class="k">def</span> <span class="nf">unset_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">):</span>
        <span class="s2">&quot;Unset flag on object&quot;</span>
        <span class="k">if</span> <span class="n">flagname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="n">flagname</span><span class="p">]</span></div>

<div class="viewcode-block" id="EvscaperoomObject.check_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.check_flag">[docs]</a>    <span class="k">def</span> <span class="nf">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">):</span>
        <span class="s2">&quot;Check if flag is set on this object&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.set_character_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.set_character_flag">[docs]</a>    <span class="k">def</span> <span class="nf">set_character_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">flagname</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="s2">&quot;Set flag on character&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
        <span class="n">flags</span><span class="p">[</span><span class="n">flagname</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.unset_character_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.unset_character_flag">[docs]</a>    <span class="k">def</span> <span class="nf">unset_character_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">flagname</span><span class="p">):</span>
        <span class="s2">&quot;Set flag on character&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
        <span class="k">if</span> <span class="n">flagname</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
            <span class="n">flags</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.check_character_flag"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.check_character_flag">[docs]</a>    <span class="k">def</span> <span class="nf">check_character_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">,</span> <span class="n">flagname</span><span class="p">):</span>
        <span class="s2">&quot;Check if flag is set on character&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
        <span class="k">return</span> <span class="n">flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">flagname</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.msg_room"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.msg_room">[docs]</a>    <span class="k">def</span> <span class="nf">msg_room</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">skip_caller</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Message everyone in the room with a message that is parsed for</span>
<span class="sd">        ~first/third person grammar, as well as for *thing markers.</span>

<span class="sd">        Args:</span>
<span class="sd">            caller (Object or None): Sender of the message. If None, there</span>
<span class="sd">                is no sender.</span>
<span class="sd">            string (str): Message to parse and send to the room.</span>
<span class="sd">            skip_caller (bool): Send to everyone except caller.</span>

<span class="sd">        Notes:</span>
<span class="sd">            Messages sent by this method will be tagged with a type of</span>
<span class="sd">            &#39;your_action&#39; and `others_action`. This is an experiment for</span>
<span class="sd">            allowing users of e.g. the webclient to redirect messages to</span>
<span class="sd">            differnt windows.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">you</span> <span class="o">=</span> <span class="n">caller</span><span class="o">.</span><span class="n">key</span> <span class="k">if</span> <span class="n">caller</span> <span class="k">else</span> <span class="s2">&quot;they&quot;</span>
        <span class="n">first_person</span><span class="p">,</span> <span class="n">third_person</span> <span class="o">=</span> <span class="n">parse_for_perspectives</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">you</span><span class="o">=</span><span class="n">you</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">get_all_characters</span><span class="p">():</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">char</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
            <span class="n">style</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;things_style&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="n">caller</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_caller</span><span class="p">:</span>
                    <span class="n">txt</span> <span class="o">=</span> <span class="n">parse_for_things</span><span class="p">(</span><span class="n">first_person</span><span class="p">,</span> <span class="n">things_style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
                    <span class="n">char</span><span class="o">.</span><span class="n">msg</span><span class="p">((</span><span class="n">txt</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;your_action&quot;</span><span class="p">}))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="n">parse_for_things</span><span class="p">(</span><span class="n">third_person</span><span class="p">,</span> <span class="n">things_style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
                <span class="n">char</span><span class="o">.</span><span class="n">msg</span><span class="p">((</span><span class="n">txt</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;others_action&quot;</span><span class="p">}))</span></div>

<div class="viewcode-block" id="EvscaperoomObject.msg_char"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.msg_char">[docs]</a>    <span class="k">def</span> <span class="nf">msg_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">client_type</span><span class="o">=</span><span class="s2">&quot;your_action&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send message only to caller (not to the room at large)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we must clean away markers</span>
        <span class="n">first_person</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">parse_for_perspectives</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">caller</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;things_style&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">parse_for_things</span><span class="p">(</span><span class="n">first_person</span><span class="p">,</span> <span class="n">things_style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
        <span class="n">caller</span><span class="o">.</span><span class="n">msg</span><span class="p">((</span><span class="n">txt</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">client_type</span><span class="p">}))</span></div>

<div class="viewcode-block" id="EvscaperoomObject.msg_system"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.msg_system">[docs]</a>    <span class="k">def</span> <span class="nf">msg_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">borders</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Send a &#39;system message&#39; by using the State.msg function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">borders</span><span class="o">=</span><span class="n">borders</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.get_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.get_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get position of caller on this object (like lying, sitting, kneeling,</span>
<span class="sd">        standing). See the Positionable child class.</span>

<span class="sd">        Args:</span>
<span class="sd">            caller (Object): The one position we seek.</span>

<span class="sd">        Returns:</span>
<span class="sd">            obj, pos (Object, str): The object we have a position relative to,</span>
<span class="sd">                as well as the name of that position (lying, sitting, kneeling,</span>
<span class="sd">                standing).  If these are None, it means we are standing on the</span>
<span class="sd">                floor.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">caller</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
            <span class="n">obj</span><span class="p">,</span> <span class="n">old_position</span> <span class="o">=</span> <span class="n">pos</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">old_position</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="EvscaperoomObject.set_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.set_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set position of caller (like lying, sitting, kneeling, standing)</span>
<span class="sd">        on this object. See Positionable child class.</span>

<span class="sd">        Args:</span>
<span class="sd">            caller (Object): The one positioning themselves on this object.</span>
<span class="sd">            new_position (str, None): One of &quot;lie&quot;, &quot;kneel&quot;, &quot;sit&quot; or &quot;stand&quot;.</span>
<span class="sd">                If `None`, remove position (character stands normally on the</span>
<span class="sd">                floor).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># reset position</span>
            <span class="n">caller</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">caller</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">positions</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">caller</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># set a new position on this object</span>
            <span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_position</span><span class="p">)</span>
            <span class="n">caller</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">caller</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_position</span></div>

<div class="viewcode-block" id="EvscaperoomObject.at_focus"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.at_focus">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when somone is focusing on this object.</span>

<span class="sd">        Args:</span>
<span class="sd">            caller (Character): The one doing the focusing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">caller</span><span class="o">.</span><span class="n">at_look</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">client_type</span><span class="o">=</span><span class="s2">&quot;look&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="EvscaperoomObject.at_unfocus"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.at_unfocus">[docs]</a>    <span class="k">def</span> <span class="nf">at_unfocus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called when focus leaves this object. Note that more than one caller</span>
<span class="sd">        may be focusing on the object at the same time, so we should not change</span>
<span class="sd">        the state of the object itself here!</span>

<span class="sd">        Args:</span>
<span class="sd">            caller (Character): The one doing the unfocusing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="EvscaperoomObject.at_speech"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.at_speech">[docs]</a>    <span class="k">def</span> <span class="nf">at_speech</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speaker</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        We don&#39;t use the default at_say hook since we handle the send logic in</span>
<span class="sd">        the command. This is only meant to trigger eventual game-events when</span>
<span class="sd">        speaking to an object or the room.</span>

<span class="sd">        Args:</span>
<span class="sd">            speaker (Character): The one speaking.</span>
<span class="sd">            action (str): One of &#39;say&#39;, &#39;whisper&#39; or &#39;shout&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="EvscaperoomObject.parse"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.parse">[docs]</a>    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple parser of focus arguments starting with a preposition,</span>
<span class="sd">        like &#39;combine with &lt;object&gt;&#39; &lt;- we want to strip out the preposition</span>
<span class="sd">        here.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^</span><span class="si">{}</span><span class="s2">\s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prep</span><span class="p">)</span> <span class="k">for</span> <span class="n">prep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_prepositions</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">args</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span></div>

<div class="viewcode-block" id="EvscaperoomObject.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This allows the object to return more detailed call signs</span>
<span class="sd">        for each of their at_focus_* methods. This is useful for</span>
<span class="sd">        things like detailed arguments (only &#39;move&#39; but &#39;move left/right&#39;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            callsigns (list, None): List of strings to inject into the</span>
<span class="sd">                available action list produced by `self.get_help`. If `None`,</span>
<span class="sd">                automatically find actions based on the method names.</span>
<span class="sd">            custom_helpstr (str): This should be the help text for</span>
<span class="sd">                the command with a marker `{callsigns}` for where to</span>
<span class="sd">                inject the list of callsigns.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">command_signatures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">helpstr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="n">inspect</span><span class="o">.</span><span class="n">ismethod</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;at_focus_&quot;</span><span class="p">):</span>
                <span class="n">command_signatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="mi">9</span><span class="p">:])</span>
        <span class="n">command_signatures</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">command_signatures</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">command_signatures</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">helpstr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;It looks like </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> may be &quot;</span> <span class="s2">&quot;suitable to </span><span class="si">{callsigns}</span><span class="s2">.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">helpstr</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;At first glance, it looks like </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> might be &quot;</span> <span class="s2">&quot;suitable to </span><span class="si">{callsigns}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">command_signatures</span><span class="p">,</span> <span class="n">helpstr</span></div>

<div class="viewcode-block" id="EvscaperoomObject.get_short_desc"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.get_short_desc">[docs]</a>    <span class="k">def</span> <span class="nf">get_short_desc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_desc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract the first sentence from the desc and use as the short desc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(^.*?[.?!])&quot;</span><span class="p">,</span> <span class="n">full_desc</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">U</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mat</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mat</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">full_desc</span></div>

<div class="viewcode-block" id="EvscaperoomObject.get_help"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.get_help">[docs]</a>    <span class="k">def</span> <span class="nf">get_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get help about this object. By default we return a</span>
<span class="sd">        listing of all actions you can do on this object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># custom-created signatures. We don&#39;t sort these</span>
        <span class="n">command_signatures</span><span class="p">,</span> <span class="n">helpstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cmd_signatures</span><span class="p">()</span>

        <span class="n">callsigns</span> <span class="o">=</span> <span class="n">list_to_string</span><span class="p">([</span><span class="s2">&quot;*&quot;</span> <span class="o">+</span> <span class="n">sig</span> <span class="k">for</span> <span class="n">sig</span> <span class="ow">in</span> <span class="n">command_signatures</span><span class="p">],</span> <span class="n">endsep</span><span class="o">=</span><span class="s2">&quot;or&quot;</span><span class="p">)</span>

        <span class="c1"># parse for *thing markers (use these as items)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">caller</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">tagcategory</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">{})</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;things_style&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">helpstr</span> <span class="o">=</span> <span class="n">helpstr</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">callsigns</span><span class="o">=</span><span class="n">callsigns</span><span class="p">)</span>
        <span class="n">helpstr</span> <span class="o">=</span> <span class="n">parse_for_things</span><span class="p">(</span><span class="n">helpstr</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">clr</span><span class="o">=</span><span class="s2">&quot;|w&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">helpstr</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span></div>

    <span class="c1"># Evennia hooks</span>

<div class="viewcode-block" id="EvscaperoomObject.return_appearance"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.EvscaperoomObject.return_appearance">[docs]</a>    <span class="k">def</span> <span class="nf">return_appearance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">looker</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Could be modified per state. We generally don&#39;t worry about the</span>
<span class="sd">        contents of the object by default.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># accept a custom desc</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;desc&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">desc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unfocused&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># use the shorter description</span>
            <span class="n">focused</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_short_desc</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
            <span class="n">helptxt</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">focused</span> <span class="o">=</span> <span class="s2">&quot; |g(examining |G- use &#39;|gex|G&#39; again to look away. See also &#39;|ghelp|G&#39;)|n&quot;</span>
            <span class="n">helptxt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;helptxt&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_help</span><span class="p">(</span><span class="n">looker</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">obj</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="n">looker</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; |w(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">position_prep_map</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="si">}</span><span class="s2"> on &quot;</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">get_display_name</span><span class="p">(</span><span class="n">looker</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">if</span> <span class="n">obj</span>
            <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot; ~~ |y</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_display_name</span><span class="p">(</span><span class="n">looker</span><span class="p">)</span><span class="si">}</span><span class="s2">|n</span><span class="si">{</span><span class="n">focused</span><span class="si">}{</span><span class="n">pos</span><span class="si">}</span><span class="s2">|n ~~</span><span class="se">\n\n</span><span class="si">{</span><span class="n">desc</span><span class="si">}{</span><span class="n">helptxt</span><span class="si">}</span><span class="s2">&quot;</span></div></div>


<div class="viewcode-block" id="Feelable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Feelable">[docs]</a><span class="k">class</span> <span class="nc">Feelable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that you can feel the surface of.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Feelable.at_focus_feel"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Feelable.at_focus_feel">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_feel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You feel *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Listenable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Listenable">[docs]</a><span class="k">class</span> <span class="nc">Listenable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object one can listen to.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Listenable.at_focus_listen"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Listenable.at_focus_listen">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_listen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You listen to *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Smellable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Smellable">[docs]</a><span class="k">class</span> <span class="nc">Smellable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object you can smell.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Smellable.at_focus_smell"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Smellable.at_focus_smell">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_smell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You smell *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Rotatable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Rotatable">[docs]</a><span class="k">class</span> <span class="nc">Rotatable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that you can lift up and look at from different angles</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rotate_flag</span> <span class="o">=</span> <span class="s2">&quot;rotatable&quot;</span>
    <span class="n">start_rotatable</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Rotatable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Rotatable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_rotatable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="s2">&quot;rotatable&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Rotatable.at_focus_rotate"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Rotatable.at_focus_rotate">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="s2">&quot;rotatable&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_rotate</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_rotate</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

    <span class="n">at_focus_turn</span> <span class="o">=</span> <span class="n">at_focus_rotate</span>

<div class="viewcode-block" id="Rotatable.at_rotate"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Rotatable.at_rotate">[docs]</a>    <span class="k">def</span> <span class="nf">at_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You turn *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> around.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Rotatable.at_cannot_rotate"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Rotatable.at_cannot_rotate">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You cannot rotate this.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Openable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable">[docs]</a><span class="k">class</span> <span class="nc">Openable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that you can open/close. It&#39;s lockable with</span>
<span class="sd">    a flag.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># this flag must be set for item to open. None for unlocked.</span>
    <span class="n">unlock_flag</span> <span class="o">=</span> <span class="s2">&quot;unlocked&quot;</span>
    <span class="n">open_flag</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
    <span class="c1"># start this item in the opened/unlocked state</span>
    <span class="n">start_open</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="Openable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_open</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unlock_flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_focus_open"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_focus_open">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_flag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_already_open</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">unlock_flag</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unlock_flag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_open</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_locked</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_focus_close"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_focus_close">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_flag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_already_closed</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unset_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_flag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_close</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_open"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_open">[docs]</a>    <span class="k">def</span> <span class="nf">at_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You open *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_already_open"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_already_open">[docs]</a>    <span class="k">def</span> <span class="nf">at_already_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> is already open.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_locked"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_locked">[docs]</a>    <span class="k">def</span> <span class="nf">at_locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> won&#39;t open.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_close"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_close">[docs]</a>    <span class="k">def</span> <span class="nf">at_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You close *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Openable.at_already_closed"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Openable.at_already_closed">[docs]</a>    <span class="k">def</span> <span class="nf">at_already_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> is already closed.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Readable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Readable">[docs]</a><span class="k">class</span> <span class="nc">Readable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that you can read from. This is controlled</span>
<span class="sd">    from a flag.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># this must be set to be able to read. None to</span>
    <span class="c1"># always be able to read.</span>

    <span class="n">read_flag</span> <span class="o">=</span> <span class="s2">&quot;readable&quot;</span>
    <span class="n">start_readable</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Readable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Readable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_readable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Readable.at_focus_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Readable.at_focus_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_flag</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_flag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_read</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_read</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

<div class="viewcode-block" id="Readable.at_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Readable.at_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You read from *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Readable.at_cannot_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Readable.at_cannot_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;You cannot understand a thing!&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="IndexReadable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.IndexReadable">[docs]</a><span class="k">class</span> <span class="nc">IndexReadable</span><span class="p">(</span><span class="n">Readable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object for which you need to specify a key/index to get a given result</span>
<span class="sd">    back. For example a lexicon or book where you enter a topic or a page</span>
<span class="sd">    number to see what&#39;s to be read on that page.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># keys should be lower-key</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;page1&quot;</span><span class="p">:</span> <span class="s2">&quot;This is page1&quot;</span><span class="p">,</span> <span class="s2">&quot;page2&quot;</span><span class="p">:</span> <span class="s2">&quot;This is page2&quot;</span><span class="p">,</span> <span class="s2">&quot;page two&quot;</span><span class="p">:</span> <span class="s2">&quot;page2&quot;</span><span class="p">}</span>  <span class="c1"># alias</span>

<div class="viewcode-block" id="IndexReadable.at_focus_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.IndexReadable.at_focus_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">topic</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">topic</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_flag</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_read</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">topic</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="c1"># an alias-reroute</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_read</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span></div>

<div class="viewcode-block" id="IndexReadable.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.IndexReadable.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;You don&#39;t have the time to read this from beginning to end. &quot;</span>
            <span class="s2">&quot;Use *read &lt;topic&gt; to look up something in particular.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[],</span> <span class="n">txt</span></div>

<div class="viewcode-block" id="IndexReadable.at_cannot_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.IndexReadable.at_cannot_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Cannot find an entry on &#39;</span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="IndexReadable.at_read"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.IndexReadable.at_read">[docs]</a>    <span class="k">def</span> <span class="nf">at_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You read about &#39;</span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s2">&#39;:</span><span class="se">\n</span><span class="si">{</span><span class="n">entry</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Movable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable">[docs]</a><span class="k">class</span> <span class="nc">Movable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that can be moved from one place to another</span>
<span class="sd">    or in one direction or another.</span>

<span class="sd">    Once moved to a given position, the object&#39;s state will</span>
<span class="sd">    change.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># these are the possible locations (or directions) to move to</span>
    <span class="c1"># name: callable</span>
    <span class="n">move_positions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="s2">&quot;at_left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="s2">&quot;at_right&quot;</span><span class="p">}</span>
    <span class="n">start_position</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>

<div class="viewcode-block" id="Movable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_position</span></div>

<div class="viewcode-block" id="Movable.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Looks like you can </span><span class="si">{callsigns}</span><span class="s2">.&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;move&quot;</span><span class="p">,</span> <span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;shove left/right&quot;</span><span class="p">],</span> <span class="n">txt</span></div>

<div class="viewcode-block" id="Movable.at_focus_move"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_focus_move">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">])</span>
        <span class="n">callfunc_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">callfunc_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">pos</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">at_already_moved</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callfunc_name</span><span class="p">)(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_move</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

    <span class="n">at_focus_shove</span> <span class="o">=</span> <span class="n">at_focus_move</span>
    <span class="n">at_focus_push</span> <span class="o">=</span> <span class="n">at_focus_move</span>

<div class="viewcode-block" id="Movable.at_cannot_move"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_cannot_move">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;That does not work.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Movable.at_already_moved"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_already_moved">[docs]</a>    <span class="k">def</span> <span class="nf">at_already_moved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You already moved *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> to the </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Movable.at_left"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_left">[docs]</a>    <span class="k">def</span> <span class="nf">at_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You move *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> left&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Movable.at_right"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Movable.at_right">[docs]</a>    <span class="k">def</span> <span class="nf">at_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You move *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> right&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BaseConsumable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseConsumable">[docs]</a><span class="k">class</span> <span class="nc">BaseConsumable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that is consumable in some way. This acts as an</span>
<span class="sd">    abstract parent.</span>

<span class="sd">    This sets a flag that</span>
<span class="sd">    is unique for each person consuming, allowing it to e.g. only</span>
<span class="sd">    be consumed once (don&#39;t support multi-uses here, that&#39;s left for</span>
<span class="sd">    a custom object if needed).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">consume_flag</span> <span class="o">=</span> <span class="s2">&quot;consume&quot;</span>
    <span class="c1"># may only consume once</span>
    <span class="n">one_consume_only</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="BaseConsumable.handle_consume"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseConsumable.handle_consume">[docs]</a>    <span class="k">def</span> <span class="nf">handle_consume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrap this by the at_focus method</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">one_consume_only</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_consumed</span><span class="p">(</span><span class="n">caller</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_already_consumed</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">has_consumed</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_consume</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConsumable.has_consumed"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseConsumable.has_consumed">[docs]</a>    <span class="k">def</span> <span class="nf">has_consumed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">setflag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="s2">&quot;Check if caller already consumed at least once&quot;</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">consume_flag</span><span class="si">}</span><span class="s2">#</span><span class="si">{</span><span class="n">caller</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">setflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConsumable.at_consume"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseConsumable.at_consume">[docs]</a>    <span class="k">def</span> <span class="nf">at_consume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;at_</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;at_</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseConsumable.at_already_consumed"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseConsumable.at_already_consumed">[docs]</a>    <span class="k">def</span> <span class="nf">at_already_consumed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You can&#39;t </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> any more.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Edible"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Edible">[docs]</a><span class="k">class</span> <span class="nc">Edible</span><span class="p">(</span><span class="n">BaseConsumable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object specifically possible to eat.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">consume_flag</span> <span class="o">=</span> <span class="s2">&quot;eat&quot;</span>

<div class="viewcode-block" id="Edible.at_focus_eat"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Edible.at_focus_eat">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_eat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_consume</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;eat&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Drinkable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Drinkable">[docs]</a><span class="k">class</span> <span class="nc">Drinkable</span><span class="p">(</span><span class="n">BaseConsumable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object specifically possible to drink.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">consume_flag</span> <span class="o">=</span> <span class="s2">&quot;drink&quot;</span>

<div class="viewcode-block" id="Drinkable.at_focus_drink"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Drinkable.at_focus_drink">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_drink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_consume</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;drink&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Drinkable.at_focus_sip"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Drinkable.at_focus_sip">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_sip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_consume</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;sip&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Drinkable.at_consume"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Drinkable.at_consume">[docs]</a>    <span class="k">def</span> <span class="nf">at_consume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> from *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Drinkable.at_already_consumed"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Drinkable.at_already_consumed">[docs]</a>    <span class="k">def</span> <span class="nf">at_already_consumed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You can&#39;t drink any more.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BaseApplicable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseApplicable">[docs]</a><span class="k">class</span> <span class="nc">BaseApplicable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that can be applied/inserted/used on another object in some way.</span>
<span class="sd">    This acts an an abstract base class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># the target object this is to be used with must</span>
    <span class="c1"># have this flag. It&#39;ll likely be unique to this</span>
    <span class="c1"># object combination.</span>
    <span class="n">target_flag</span> <span class="o">=</span> <span class="s2">&quot;applicable&quot;</span>

<div class="viewcode-block" id="BaseApplicable.handle_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseApplicable.handle_apply">[docs]</a>    <span class="k">def</span> <span class="nf">handle_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrap this with the at_focus methods in the child classes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;You need to specify a target.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">can_apply</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_flag</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">can_apply</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">can_apply</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_apply</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_apply</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseApplicable.at_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseApplicable.at_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="BaseApplicable.at_cannot_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BaseApplicable.at_cannot_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You cannot </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Usable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Usable">[docs]</a><span class="k">class</span> <span class="nc">Usable</span><span class="p">(</span><span class="n">BaseApplicable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that can be used with another object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">target_flag</span> <span class="o">=</span> <span class="s2">&quot;usable&quot;</span>

<div class="viewcode-block" id="Usable.at_focus_use"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Usable.at_focus_use">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_use</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_apply</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;use&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Usable.at_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Usable.at_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Usable.at_cannot_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Usable.at_cannot_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You cannot </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Insertable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Insertable">[docs]</a><span class="k">class</span> <span class="nc">Insertable</span><span class="p">(</span><span class="n">BaseApplicable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that can be inserted into another object.</span>

<span class="sd">    This would cover a key, for example.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># this would likely be a custom name</span>
    <span class="n">target_flag</span> <span class="o">=</span> <span class="s2">&quot;insertable&quot;</span>

<div class="viewcode-block" id="Insertable.at_focus_insert"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Insertable.at_focus_insert">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_apply</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;insert&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Insertable.at_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Insertable.at_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Insertable.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Insertable.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;You can use this object to </span><span class="si">{callsigns}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;insert in &lt;object&gt;&quot;</span><span class="p">],</span> <span class="n">txt</span></div>

<div class="viewcode-block" id="Insertable.at_cannot_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Insertable.at_cannot_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You cannot </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Combinable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Combinable">[docs]</a><span class="k">class</span> <span class="nc">Combinable</span><span class="p">(</span><span class="n">BaseApplicable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object that combines with another object to create</span>
<span class="sd">    a new one.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># the other object must have this flag to be able to be combined</span>
    <span class="c1"># (this is likely unique for a given combination)</span>
    <span class="n">target_flag</span> <span class="o">=</span> <span class="s2">&quot;combinable&quot;</span>
    <span class="c1"># create-dict to pass into the create_object for the</span>
    <span class="c1"># new &quot;combined&quot; object.</span>
    <span class="n">new_create_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;typeclass&quot;</span><span class="p">:</span> <span class="s2">&quot;evscaperoom.objects.Combinable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;sword&quot;</span><span class="p">,</span>
        <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;combined&quot;</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="c1"># if set, destroy the two components used to make the new one</span>
    <span class="n">destroy_components</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Combinable.at_focus_combine"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Combinable.at_focus_combine">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_focus_apply</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Combinable.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Combinable.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;It looks like this should work: </span><span class="si">{callsigns}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;combine &lt;object&gt;&quot;</span><span class="p">],</span> <span class="n">txt</span></div>

<div class="viewcode-block" id="Combinable.at_cannot_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Combinable.at_cannot_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You cannot </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Combinable.at_apply"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Combinable.at_apply">[docs]</a>    <span class="k">def</span> <span class="nf">at_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">other_obj</span><span class="p">):</span>
        <span class="n">create_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_create_dict</span>
        <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">create_dict</span><span class="p">:</span>
            <span class="n">create_dict</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span>
        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">create_evscaperoom_object</span><span class="p">(</span><span class="o">**</span><span class="n">create_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_obj</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">destroy_components</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span>
                <span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;You combine *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">other_obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> to make </span><span class="si">{</span><span class="n">new_obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">!&quot;</span>
            <span class="p">)</span>
            <span class="n">other_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="Mixable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable">[docs]</a><span class="k">class</span> <span class="nc">Mixable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object into which you can mix ingredients (such as when</span>
<span class="sd">    mixing a potion). This offers no actions on its own, instead</span>
<span class="sd">    the ingredients should be &#39;used&#39; with this object in order</span>
<span class="sd">    mix, calling at_mix when they do.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># ingredients can check for this before they allow to mix at all</span>
    <span class="n">mixer_flag</span> <span class="o">=</span> <span class="s2">&quot;mixer&quot;</span>
    <span class="c1"># ingredients must have these flags and this order</span>
    <span class="n">ingredient_recipe</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ingredient1&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredient2&quot;</span><span class="p">,</span> <span class="s2">&quot;ingredient3&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="Mixable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_flag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mixer_flag</span><span class="p">)</span>
        <span class="c1"># this holds the ingredients as they are added</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="Mixable.check_mixture"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.check_mixture">[docs]</a>    <span class="k">def</span> <span class="nf">check_mixture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s2">&quot;check so mixture is correct, returning True/False.&quot;</span>
        <span class="n">ingredients</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iflag</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredient_recipe</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">ingredients</span><span class="p">[</span><span class="n">iflag</span><span class="p">]</span><span class="o">.</span><span class="n">check_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># we only get here if all ingredients have the right flags in the right</span>
        <span class="c1"># order</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Mixable.handle_mix"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.handle_mix">[docs]</a>    <span class="k">def</span> <span class="nf">handle_mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add ingredient object to mixture.</span>

<span class="sd">        Called by the mixing ingredient. We assume the ingredient has already</span>
<span class="sd">        checked to make sure they allow themselves to be mixed into an object</span>
<span class="sd">        with this mixer_flag.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ingredient</span><span class="p">)</span>
        <span class="c1"># normal mix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">at_mix</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ingredient_recipe</span><span class="p">):</span>
            <span class="c1"># we have enough, check if it matches recipe</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_mixture</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">at_mix_success</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">room</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> mix failure: Tried </span><span class="si">{</span><span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ing</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">ing</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span> <span class="k">if</span> <span class="n">ing</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">ingredients</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">at_mix_failure</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mixable.at_mix"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.at_mix">[docs]</a>    <span class="k">def</span> <span class="nf">at_mix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_room</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;~You ~mix </span><span class="si">{</span><span class="n">ingredient</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> into *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mixable.at_mix_failure"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.at_mix_failure">[docs]</a>    <span class="k">def</span> <span class="nf">at_mix_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_room</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;This mix doesn&#39;t work. ~You ~clean and start over.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mixable.at_mix_success"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Mixable.at_mix_success">[docs]</a>    <span class="k">def</span> <span class="nf">at_mix_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">ingredient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_room</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;~You successfully ~complete the mix!&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="HasButtons"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons">[docs]</a><span class="k">class</span> <span class="nc">HasButtons</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object with buttons to push/press</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># mapping keys/aliases to calling method</span>
    <span class="n">buttons</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;green button&quot;</span><span class="p">:</span> <span class="s2">&quot;at_green_button&quot;</span><span class="p">,</span>
        <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="s2">&quot;at_green_button&quot;</span><span class="p">,</span>
        <span class="s2">&quot;red button&quot;</span><span class="p">:</span> <span class="s2">&quot;at_red_button&quot;</span><span class="p">,</span>
        <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="s2">&quot;at_red_button&quot;</span><span class="p">,</span>
    <span class="p">}</span>

<div class="viewcode-block" id="HasButtons.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">helptxt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;It looks like you should be able to operate &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> by means of &quot;</span>
            <span class="s2">&quot;</span><span class="si">{callsigns}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;press red/green button&quot;</span><span class="p">],</span> <span class="n">helptxt</span></div>

<div class="viewcode-block" id="HasButtons.at_focus_press"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons.at_focus_press">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_press</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">])</span>
        <span class="n">callfunc_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">callfunc_name</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callfunc_name</span><span class="p">)(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_nomatch</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span></div>

    <span class="n">at_focus_push</span> <span class="o">=</span> <span class="n">at_focus_press</span>

<div class="viewcode-block" id="HasButtons.at_nomatch"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons.at_nomatch">[docs]</a>    <span class="k">def</span> <span class="nf">at_nomatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;That does not seem right.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="HasButtons.at_green_button"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons.at_green_button">[docs]</a>    <span class="k">def</span> <span class="nf">at_green_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;You press the green button.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="HasButtons.at_red_button"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.HasButtons.at_red_button">[docs]</a>    <span class="k">def</span> <span class="nf">at_red_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;You press the red button.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CodeInput"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput">[docs]</a><span class="k">class</span> <span class="nc">CodeInput</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object where you can enter a code of some sort</span>
<span class="sd">    to have an effect happen.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># the code of this</span>
    <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;PASSWORD&quot;</span>
    <span class="n">code_hint</span> <span class="o">=</span> <span class="s2">&quot;eight letters A-Z&quot;</span>
    <span class="n">case_insensitive</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># code locked no matter what is input</span>
    <span class="n">infinitely_locked</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="CodeInput.at_focus_code"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput.at_focus_code">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_no_code</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">infinitely_locked</span><span class="p">:</span>
            <span class="n">code_correct</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_insensitive</span><span class="p">:</span>
            <span class="n">code_correct</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code_correct</span> <span class="o">=</span> <span class="n">args</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span>

        <span class="k">if</span> <span class="n">code_correct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_code_correct</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_code_incorrect</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeInput.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">helptxt</span> <span class="o">=</span> <span class="s2">&quot;Looks like you need to use </span><span class="si">{callsigns}</span><span class="s2">.&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;code &lt;code&gt;&quot;</span><span class="p">],</span> <span class="n">helptxt</span></div>

<div class="viewcode-block" id="CodeInput.at_no_code"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput.at_no_code">[docs]</a>    <span class="k">def</span> <span class="nf">at_no_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Looks like you need to enter |w</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_hint</span><span class="si">}</span><span class="s2">|n.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeInput.at_code_correct"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput.at_code_correct">[docs]</a>    <span class="k">def</span> <span class="nf">at_code_correct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">code_tried</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;That&#39;s the right code!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="CodeInput.at_code_incorrect"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.CodeInput.at_code_incorrect">[docs]</a>    <span class="k">def</span> <span class="nf">at_code_incorrect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">code_tried</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;That&#39;s not the right code (need </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_hint</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BasePositionable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable">[docs]</a><span class="k">class</span> <span class="nc">BasePositionable</span><span class="p">(</span><span class="n">EvscaperoomObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object a character can be positioned on. This is meant as an</span>
<span class="sd">    abstract parent.</span>

<span class="sd">    This is a little special since a char can only have one position at a</span>
<span class="sd">    time and must therefore be aware of the other &#39;positional&#39; actions</span>
<span class="sd">    any object may support (otherwise you may end up sitting/standing/etc on</span>
<span class="sd">    more than one object at once!)</span>

<span class="sd">    We set a Attribute (obj, position) on the caller to indicate that</span>
<span class="sd">    they have a position on an object. This is necessary so as to not have</span>
<span class="sd">    the caller sit on more than one sittable object at a time, for example. The</span>
<span class="sd">    &#39;positions&#39; Attribute on this object holds a mapping of who is sitting</span>
<span class="sd">    lying etc on this object.  We don&#39;t add a limit to how many chars could</span>
<span class="sd">    have a position on an object - it&#39;s not realistic, but this goes with the</span>
<span class="sd">    philosophy that one character should not be able to block others if they go</span>
<span class="sd">    inactive etc.</span>

<span class="sd">    This state is also tied to the general &#39;stand&#39; command, which should return</span>
<span class="sd">    the player to the normal standing state regardless of if they focus on this</span>
<span class="sd">    object or not.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="BasePositionable.at_object_creation"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable.at_object_creation">[docs]</a>    <span class="k">def</span> <span class="nf">at_object_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">at_object_creation</span><span class="p">()</span>
        <span class="c1"># mapping {object: position}.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="BasePositionable.handle_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable.handle_position">[docs]</a>    <span class="k">def</span> <span class="nf">handle_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrap this with the at_focus_ method of the child class.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_obj</span><span class="p">,</span> <span class="n">old_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="n">caller</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">old_obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">old_obj</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">old_pos</span> <span class="o">==</span> <span class="n">new_pos</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">at_again_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">at_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">at_cannot_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">,</span> <span class="n">old_obj</span><span class="p">,</span> <span class="n">old_pos</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">at_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">)</span></div>

<div class="viewcode-block" id="BasePositionable.at_cannot_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable.at_cannot_position">[docs]</a>    <span class="k">def</span> <span class="nf">at_cannot_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">old_obj</span><span class="p">,</span> <span class="n">old_pos</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span>
            <span class="n">caller</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;You can&#39;t; you are currently </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">position_prep_map</span><span class="p">[</span><span class="n">old_pos</span><span class="p">]</span><span class="si">}</span><span class="s2"> on *</span><span class="si">{</span><span class="n">old_obj</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="s2">&quot;(better |wstand|n first).&quot;</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="BasePositionable.at_again_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable.at_again_position">[docs]</a>    <span class="k">def</span> <span class="nf">at_again_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_char</span><span class="p">(</span>
            <span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;But you are already </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">position_prep_map</span><span class="p">[</span><span class="n">position</span><span class="p">]</span><span class="si">}</span><span class="s2"> on *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">?&quot;</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="BasePositionable.at_position"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.BasePositionable.at_position">[docs]</a>    <span class="k">def</span> <span class="nf">at_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_room</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;~You ~</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2"> on *</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Sittable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Sittable">[docs]</a><span class="k">class</span> <span class="nc">Sittable</span><span class="p">(</span><span class="n">BasePositionable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object you can sit on.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Sittable.at_focus_sit"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Sittable.at_focus_sit">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_sit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;sit&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Liable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Liable">[docs]</a><span class="k">class</span> <span class="nc">Liable</span><span class="p">(</span><span class="n">BasePositionable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object you can lie down on.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Liable.at_focus_lie"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Liable.at_focus_lie">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_lie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;lie&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Kneelable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Kneelable">[docs]</a><span class="k">class</span> <span class="nc">Kneelable</span><span class="p">(</span><span class="n">BasePositionable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object you can kneel on.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Kneelable.at_focus_kneel"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Kneelable.at_focus_kneel">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_kneel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;kneel&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Climbable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Climbable">[docs]</a><span class="k">class</span> <span class="nc">Climbable</span><span class="p">(</span><span class="n">BasePositionable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any object you can climb up to stand on. We name this</span>
<span class="sd">    &#39;climb&#39; so as to not collide with the general &#39;stand&#39;</span>
<span class="sd">    command, which resets your position.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Climbable.at_focus_climb"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Climbable.at_focus_climb">[docs]</a>    <span class="k">def</span> <span class="nf">at_focus_climb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">caller</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">handle_position</span><span class="p">(</span><span class="n">caller</span><span class="p">,</span> <span class="s2">&quot;climb&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Positionable"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Positionable">[docs]</a><span class="k">class</span> <span class="nc">Positionable</span><span class="p">(</span><span class="n">Sittable</span><span class="p">,</span> <span class="n">Liable</span><span class="p">,</span> <span class="n">Kneelable</span><span class="p">,</span> <span class="n">Climbable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An object on which you can position yourself in one of the</span>
<span class="sd">    supported ways (sit, lie, kneel or climb)</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Positionable.get_cmd_signatures"><a class="viewcode-back" href="../../../../api/evennia.contrib.evscaperoom.objects.html#evennia.contrib.evscaperoom.objects.Positionable.get_cmd_signatures">[docs]</a>    <span class="k">def</span> <span class="nf">get_cmd_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;It looks like you can </span><span class="si">{callsigns}</span><span class="s2"> on it.&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;sit&quot;</span><span class="p">,</span> <span class="s2">&quot;lie&quot;</span><span class="p">,</span> <span class="s2">&quot;kneel&quot;</span><span class="p">,</span> <span class="s2">&quot;climb&quot;</span><span class="p">],</span> <span class="n">txt</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/evennia_logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><h3>Links</h3>
<ul>
  <li><a href="https://www.evennia.com">Home page</a> </li>
  <li><a href="https://github.com/evennia/evennia">Evennia Github</a> </li>
  <li><a href="http://games.evennia.com">Game Index</a> </li>
  <li>
    <a href="https://discord.gg/AJJpcRUhtF">Discord</a> -
     <a href="https://github.com/evennia/evennia/discussions">Discussions</a> -
      <a href="https://evennia.blogspot.com/">Blog</a>
  </li>
</ul>
<h3>Versions</h3>
<ul>
  <li><a href="objects.html">1.0-dev (develop branch)</a></li>
  <li><a href="../../../../../0.9.5/index.html">0.9.5 (v0.9.5 branch)</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Evennia 1.0-dev</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../evennia.html" >evennia</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.contrib.evscaperoom.objects</a></li> 
      </ul>
        <div class="develop">develop branch</div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, The Evennia developer community.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>