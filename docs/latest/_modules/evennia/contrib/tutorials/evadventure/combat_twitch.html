<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>evennia.contrib.tutorials.evadventure.combat_twitch &#8212; Evennia latest documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/nature.css?v=279e0f84" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css?v=e4a91a55" />
    <script src="../../../../../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Evennia</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../../evennia.html" accesskey="U">evennia</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.contrib.tutorials.evadventure.combat_twitch</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for evennia.contrib.tutorials.evadventure.combat_twitch</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">EvAdventure Twitch-based combat</span>

<span class="sd">This implements a &#39;twitch&#39; (aka DIKU or other traditional muds) style of MUD combat.</span>

<span class="sd">----</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">evennia</span><span class="w"> </span><span class="kn">import</span> <span class="n">AttributeProperty</span><span class="p">,</span> <span class="n">CmdSet</span><span class="p">,</span> <span class="n">default_cmds</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">evennia.commands.command</span><span class="w"> </span><span class="kn">import</span> <span class="n">Command</span><span class="p">,</span> <span class="n">InterruptCommand</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">evennia.utils.utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">display_len</span><span class="p">,</span>
    <span class="n">inherits_from</span><span class="p">,</span>
    <span class="n">list_to_string</span><span class="p">,</span>
    <span class="n">pad</span><span class="p">,</span>
    <span class="n">repeat</span><span class="p">,</span>
    <span class="n">unrepeat</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.characters</span><span class="w"> </span><span class="kn">import</span> <span class="n">EvAdventureCharacter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.combat_base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">CombatActionAttack</span><span class="p">,</span>
    <span class="n">CombatActionHold</span><span class="p">,</span>
    <span class="n">CombatActionStunt</span><span class="p">,</span>
    <span class="n">CombatActionUseItem</span><span class="p">,</span>
    <span class="n">CombatActionWield</span><span class="p">,</span>
    <span class="n">EvAdventureCombatBaseHandler</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABILITY_REVERSE_MAP</span>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EvAdventureCombatTwitchHandler</span><span class="p">(</span><span class="n">EvAdventureCombatBaseHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is created on the combatant when combat starts. It tracks only the combatants</span>
<span class="sd">    side of the combat and handles when the next action will happen.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># fixed properties</span>
    <span class="n">action_classes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;hold&quot;</span><span class="p">:</span> <span class="n">CombatActionHold</span><span class="p">,</span>
        <span class="s2">&quot;attack&quot;</span><span class="p">:</span> <span class="n">CombatActionAttack</span><span class="p">,</span>
        <span class="s2">&quot;stunt&quot;</span><span class="p">:</span> <span class="n">CombatActionStunt</span><span class="p">,</span>
        <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="n">CombatActionUseItem</span><span class="p">,</span>
        <span class="s2">&quot;wield&quot;</span><span class="p">:</span> <span class="n">CombatActionWield</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># dynamic properties</span>

    <span class="n">advantage_against</span> <span class="o">=</span> <span class="n">AttributeProperty</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">disadvantage_against</span> <span class="o">=</span> <span class="n">AttributeProperty</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>

    <span class="n">action_dict</span> <span class="o">=</span> <span class="n">AttributeProperty</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">fallback_action_dict</span> <span class="o">=</span> <span class="n">AttributeProperty</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;hold&quot;</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

    <span class="c1"># stores the current ticker reference, so we can manipulate it later</span>
    <span class="n">current_ticker_ref</span> <span class="o">=</span> <span class="n">AttributeProperty</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.msg">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.msg">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Central place for sending messages to combatants. This allows</span>
<span class="sd">        for adding any combat-specific text-decoration in one place.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): The message to send.</span>
<span class="sd">            combatant (Object): The &#39;You&#39; in the message, if any.</span>
<span class="sd">            broadcast (bool): If `False`, `combatant` must be included and</span>
<span class="sd">                will be the only one to see the message. If `True`, send to</span>
<span class="sd">                everyone in the location.</span>
<span class="sd">            location (Object, optional): If given, use this as the location to</span>
<span class="sd">                send broadcast messages to. If not, use `self.obj` as that</span>
<span class="sd">                location.</span>

<span class="sd">        Notes:</span>
<span class="sd">            If `combatant` is given, use `$You/you()` markup to create</span>
<span class="sd">            a message that looks different depending on who sees it. Use</span>
<span class="sd">            `$You(combatant_key)` to refer to other combatants.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">combatant</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">location</span><span class="p">)</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.at_init">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.at_init">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">at_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">cmdset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">TwitchLookCmdSet</span><span class="p">,</span> <span class="n">persistent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.get_sides">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.get_sides">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_sides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combatant</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a listing of the two &#39;sides&#39; of this combat, from the perspective of the provided</span>
<span class="sd">        combatant. The sides don&#39;t need to be balanced.</span>

<span class="sd">        Args:</span>
<span class="sd">            combatant (Character or NPC): The one whose sides are to determined.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple: A tuple of lists `(allies, enemies)`, from the perspective of `combatant`.</span>
<span class="sd">                Note that combatant itself is not included in either of these.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get all entities involved in combat by looking up their combathandlers</span>
        <span class="n">combatants</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">comb</span>
            <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">contents</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span class="s2">&quot;scripts&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comb</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">location</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="s2">&quot;allow_pvp&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">location</span><span class="o">.</span><span class="n">allow_pvp</span><span class="p">:</span>
            <span class="c1"># in pvp, everyone else is an enemy</span>
            <span class="n">allies</span> <span class="o">=</span> <span class="p">[</span><span class="n">combatant</span><span class="p">]</span>
            <span class="n">enemies</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combatants</span> <span class="k">if</span> <span class="n">comb</span> <span class="o">!=</span> <span class="n">combatant</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># otherwise, enemies/allies depend on who combatant is</span>
            <span class="n">pcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combatants</span> <span class="k">if</span> <span class="n">inherits_from</span><span class="p">(</span><span class="n">comb</span><span class="p">,</span> <span class="n">EvAdventureCharacter</span><span class="p">)]</span>
            <span class="n">npcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">combatants</span> <span class="k">if</span> <span class="n">comb</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pcs</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">combatant</span> <span class="ow">in</span> <span class="n">pcs</span><span class="p">:</span>
                <span class="c1"># combatant is a PC, so NPCs are all enemies</span>
                <span class="n">allies</span> <span class="o">=</span> <span class="n">pcs</span>
                <span class="n">enemies</span> <span class="o">=</span> <span class="n">npcs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># combatant is an NPC, so PCs are all enemies</span>
                <span class="n">allies</span> <span class="o">=</span> <span class="n">npcs</span>
                <span class="n">enemies</span> <span class="o">=</span> <span class="n">pcs</span>
        <span class="k">return</span> <span class="n">allies</span><span class="p">,</span> <span class="n">enemies</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.give_advantage">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.give_advantage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">give_advantage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Let a benefiter gain advantage against the target.</span>

<span class="sd">        Args:</span>
<span class="sd">            recipient (Character or NPC): The one to gain the advantage. This may or may not</span>
<span class="sd">                be the same entity that creates the advantage in the first place.</span>
<span class="sd">            target (Character or NPC): The one against which the target gains advantage. This</span>
<span class="sd">                could (in principle) be the same as the benefiter (e.g. gaining advantage on</span>
<span class="sd">                some future boost)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advantage_against</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.give_disadvantage">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.give_disadvantage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">give_disadvantage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Let an affected party gain disadvantage against a target.</span>

<span class="sd">        Args:</span>
<span class="sd">            recipient (Character or NPC): The one to get the disadvantage.</span>
<span class="sd">            target (Character or NPC): The one against which the target gains disadvantage, usually</span>
<span class="sd">                an enemy.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disadvantage_against</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.has_advantage">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.has_advantage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_advantage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combatant</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a given combatant has advantage against a target.</span>

<span class="sd">        Args:</span>
<span class="sd">            combatant (Character or NPC): The one to check if they have advantage</span>
<span class="sd">            target (Character or NPC): The target to check advantage against.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">advantage_against</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.has_disadvantage">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.has_disadvantage">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">has_disadvantage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combatant</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if a given combatant has disadvantage against a target.</span>

<span class="sd">        Args:</span>
<span class="sd">            combatant (Character or NPC): The one to check if they have disadvantage</span>
<span class="sd">            target (Character or NPC): The target to check disadvantage against.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">disadvantage_against</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.queue_action">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.queue_action">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">queue_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">,</span> <span class="n">combatant</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Schedule the next action to fire.</span>

<span class="sd">        Args:</span>
<span class="sd">            action_dict (dict): The new action-dict to initialize.</span>
<span class="sd">            combatant: Unused.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">action_dict</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_classes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;This is an unkown action!&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># store action dict and schedule it to run in dt time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_dict</span> <span class="o">=</span> <span class="n">action_dict</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">action_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dt&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ticker_ref</span><span class="p">:</span>
            <span class="c1"># we already have a current ticker going - abort it</span>
            <span class="n">unrepeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ticker_ref</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dt</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># no repeat</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_ticker_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># always schedule the task to be repeating, cancel later otherwise. We store</span>
            <span class="c1"># the tickerhandler&#39;s ref to make sure we can remove it later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_ticker_ref</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_next_action</span><span class="p">,</span> <span class="n">id_string</span><span class="o">=</span><span class="s2">&quot;combat&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.execute_next_action">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.execute_next_action">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute_next_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Triggered after a delay by the command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">combatant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
        <span class="n">action_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_dict</span>
        <span class="n">action_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_classes</span><span class="p">[</span><span class="n">action_dict</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]]</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">action_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combatant</span><span class="p">,</span> <span class="n">action_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">action</span><span class="o">.</span><span class="n">can_use</span><span class="p">():</span>
            <span class="n">action</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="n">action</span><span class="o">.</span><span class="n">post_execute</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">action_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;repeat&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="c1"># not a repeating action, use the fallback (normally the original attack)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">action_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fallback_action_dict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">queue_action</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fallback_action_dict</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_stop_combat</span><span class="p">()</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.check_stop_combat">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.check_stop_combat">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">check_stop_combat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the combat is over.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">allies</span><span class="p">,</span> <span class="n">enemies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sides</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">location</span>

        <span class="c1"># only keep combatants that are alive and still in the same room</span>
        <span class="n">allies</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">allies</span> <span class="k">if</span> <span class="n">comb</span><span class="o">.</span><span class="n">hp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">comb</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">location</span><span class="p">]</span>
        <span class="n">enemies</span> <span class="o">=</span> <span class="p">[</span><span class="n">comb</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">enemies</span> <span class="k">if</span> <span class="n">comb</span><span class="o">.</span><span class="n">hp</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">comb</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">location</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">allies</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">enemies</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Noone stands after the dust settles.&quot;</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_combat</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">allies</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">enemies</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allies</span> <span class="o">+</span> <span class="n">enemies</span> <span class="o">==</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;The combat is over.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">still_standing</span> <span class="o">=</span> <span class="n">list_to_string</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$You(</span><span class="si">{</span><span class="n">comb</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">comb</span> <span class="ow">in</span> <span class="n">allies</span> <span class="o">+</span> <span class="n">enemies</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The combat is over. Still standing: </span><span class="si">{</span><span class="n">still_standing</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="n">broadcast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_combat</span><span class="p">()</span></div>


<div class="viewcode-block" id="EvAdventureCombatTwitchHandler.stop_combat">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.EvAdventureCombatTwitchHandler.stop_combat">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stop_combat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop combat immediately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue_action</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;hold&quot;</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>  <span class="c1"># make sure ticker is killed</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">ndb</span><span class="o">.</span><span class="n">combathandler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">cmdset</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">TwitchLookCmdSet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">_BaseTwitchCombatCommand</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parent class for all twitch-combat commnads.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">at_pre_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Called before parsing.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">location</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">allow_combat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Can&#39;t fight here!&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle parsing of most supported combat syntaxes (except stunts).</span>

<span class="sd">        &lt;action&gt; [&lt;target&gt;|&lt;item&gt;]</span>
<span class="sd">        or</span>
<span class="sd">        &lt;action&gt; &lt;item&gt; [on] &lt;target&gt;</span>

<span class="sd">        Use &#39;on&#39; to differentiate if names/items have spaces in the name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="s2">&quot; on &quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; on &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lhs</span><span class="p">,</span> <span class="o">*</span><span class="n">rhs</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">rhs</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span> <span class="o">=</span> <span class="n">lhs</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">rhs</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_or_create_combathandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">combathandler_key</span><span class="o">=</span><span class="s2">&quot;combathandler&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get or create the combathandler assigned to this combatant.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">target</span><span class="p">:</span>
            <span class="c1"># add/check combathandler to the target</span>
            <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">hp_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;You can&#39;t attack that!&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

            <span class="n">EvAdventureCombatTwitchHandler</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">(</span>
                <span class="n">target</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">combathandler_key</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">EvAdventureCombatTwitchHandler</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span>


<div class="viewcode-block" id="CmdAttack">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdAttack">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdAttack</span><span class="p">(</span><span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attack a target. Will keep attacking the target until</span>
<span class="sd">    combat ends or another combat action is taken.</span>

<span class="sd">    Usage:</span>
<span class="sd">        attack/hit &lt;target&gt;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;attack&quot;</span>
    <span class="n">aliases</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hit&quot;</span><span class="p">]</span>
    <span class="n">help_category</span> <span class="o">=</span> <span class="s2">&quot;combat&quot;</span>

<div class="viewcode-block" id="CmdAttack.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdAttack.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lhs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="c1"># we use a fixed dt of 3 here, to mimic Diku style; one could also picture</span>
        <span class="c1"># attacking at a different rate, depending on skills/weapon etc.</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">queue_action</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;attack&quot;</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;repeat&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$You() $conj(attack) $You(</span><span class="si">{</span><span class="n">target</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">)!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CmdLook">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdLook">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdLook</span><span class="p">(</span><span class="n">default_cmds</span><span class="o">.</span><span class="n">CmdLook</span><span class="p">,</span> <span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<div class="viewcode-block" id="CmdLook.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdLook.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># get regular look, followed by a combat summary</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">func</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">()</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">combathandler</span><span class="o">.</span><span class="n">get_combat_summary</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">))</span>
            <span class="n">maxwidth</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">display_len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">txt</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|r</span><span class="si">{</span><span class="n">pad</span><span class="p">(</span><span class="s1">&#39; Combat Status &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="n">maxwidth</span><span class="p">,</span><span class="w"> </span><span class="n">fillchar</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">|n</span><span class="se">\n</span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CmdHold">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdHold">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdHold</span><span class="p">(</span><span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hold back your blows, doing nothing.</span>

<span class="sd">    Usage:</span>
<span class="sd">        hold</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;hold&quot;</span>

<div class="viewcode-block" id="CmdHold.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdHold.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">()</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">queue_action</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;hold&quot;</span><span class="p">})</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;$You() $conj(hold) back, doing nothing.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CmdStunt">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdStunt">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdStunt</span><span class="p">(</span><span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a combat stunt, that boosts an ally against a target, or</span>
<span class="sd">    foils an enemy, giving them disadvantage against an ally.</span>

<span class="sd">    Usage:</span>
<span class="sd">        boost [ability] &lt;recipient&gt; &lt;target&gt;</span>
<span class="sd">        foil [ability] &lt;recipient&gt; &lt;target&gt;</span>
<span class="sd">        boost [ability] &lt;target&gt;       (same as boost me &lt;target&gt;)</span>
<span class="sd">        foil [ability] &lt;target&gt;        (same as foil &lt;target&gt; me)</span>

<span class="sd">    Example:</span>
<span class="sd">        boost STR me Goblin</span>
<span class="sd">        boost DEX Goblin</span>
<span class="sd">        foil STR Goblin me</span>
<span class="sd">        foil INT Goblin</span>
<span class="sd">        boost INT Wizard Goblin</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;stunt&quot;</span>
    <span class="n">aliases</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;boost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;foil&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">help_category</span> <span class="o">=</span> <span class="s2">&quot;combat&quot;</span>

<div class="viewcode-block" id="CmdStunt.parse">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdStunt.parse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">or</span> <span class="s2">&quot; &quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Usage: &lt;ability&gt; &lt;recipient&gt; &lt;target&gt;&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

        <span class="n">advantage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmdname</span> <span class="o">!=</span> <span class="s2">&quot;foil&quot;</span>

        <span class="c1"># extract data from the input</span>

        <span class="n">stunt_type</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="n">stunt_type</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stunt_type</span><span class="p">:</span>
            <span class="n">stunt_type</span> <span class="o">=</span> <span class="n">stunt_type</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">args</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">recipient</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">args</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># validate input and try to guess if not given</span>

        <span class="c1"># ability is requried</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stunt_type</span> <span class="ow">or</span> <span class="n">stunt_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ABILITY_REVERSE_MAP</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">stunt_type</span><span class="si">}</span><span class="s2">&#39; is not a valid ability. Pick one of&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ABILITY_REVERSE_MAP</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">recipient</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Must give at least a recipient or target.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
            <span class="c1"># something like `boost str target`</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">recipient</span> <span class="k">if</span> <span class="n">advantage</span> <span class="k">else</span> <span class="s2">&quot;me&quot;</span>
            <span class="n">recipient</span> <span class="o">=</span> <span class="s2">&quot;me&quot;</span> <span class="k">if</span> <span class="n">advantage</span> <span class="k">else</span> <span class="n">recipient</span>

        <span class="c1"># if we still have None:s at this point, we can&#39;t continue</span>
        <span class="k">if</span> <span class="kc">None</span> <span class="ow">in</span> <span class="p">(</span><span class="n">stunt_type</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;Both ability, recipient and  target of stunt must be given.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

        <span class="c1"># save what we found so it can be accessed from func()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advantage</span> <span class="o">=</span> <span class="n">advantage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stunt_type</span> <span class="o">=</span> <span class="n">ABILITY_REVERSE_MAP</span><span class="p">[</span><span class="n">stunt_type</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipient</span> <span class="o">=</span> <span class="n">recipient</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>


<div class="viewcode-block" id="CmdStunt.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdStunt.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">recipient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recipient</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">recipient</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>

        <span class="n">combathandler</span><span class="o">.</span><span class="n">queue_action</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;stunt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;recipient&quot;</span><span class="p">:</span> <span class="n">recipient</span><span class="p">,</span>
                <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
                <span class="s2">&quot;advantage&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">advantage</span><span class="p">,</span>
                <span class="s2">&quot;stunt_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stunt_type</span><span class="p">,</span>
                <span class="s2">&quot;defense_type&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stunt_type</span><span class="p">,</span>
                <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;$You() prepare a stunt!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CmdUseItem">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdUseItem">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdUseItem</span><span class="p">(</span><span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use an item in combat. The item must be in your inventory to use.</span>

<span class="sd">    Usage:</span>
<span class="sd">        use &lt;item&gt;</span>
<span class="sd">        use &lt;item&gt; [on] &lt;target&gt;</span>

<span class="sd">    Examples:</span>
<span class="sd">        use potion</span>
<span class="sd">        use throwing knife on goblin</span>
<span class="sd">        use bomb goblin</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;use&quot;</span>
    <span class="n">help_category</span> <span class="o">=</span> <span class="s2">&quot;combat&quot;</span>

<div class="viewcode-block" id="CmdUseItem.parse">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdUseItem.parse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;What do you want to use?&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lhs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rhs</span> <span class="ow">or</span> <span class="s2">&quot;me&quot;</span></div>


<div class="viewcode-block" id="CmdUseItem.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdUseItem.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">equipment</span><span class="o">.</span><span class="n">get_usable_objects_from_backpack</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;(You must carry the item to use it.)&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
            <span class="n">target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">queue_action</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;use&quot;</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;$You() prepare to use </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">get_display_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CmdWield">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdWield">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CmdWield</span><span class="p">(</span><span class="n">_BaseTwitchCombatCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wield a weapon or spell-rune. You will the wield the item, swapping with any other item(s) you</span>
<span class="sd">    were wielded before.</span>

<span class="sd">    Usage:</span>
<span class="sd">      wield &lt;weapon or spell&gt;</span>

<span class="sd">    Examples:</span>
<span class="sd">      wield sword</span>
<span class="sd">      wield shield</span>
<span class="sd">      wield fireball</span>

<span class="sd">    Note that wielding a shield will not replace the sword in your hand, while wielding a two-handed</span>
<span class="sd">    weapon (or a spell-rune) will take two hands and swap out what you were carrying.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;wield&quot;</span>
    <span class="n">help_category</span> <span class="o">=</span> <span class="s2">&quot;combat&quot;</span>

<div class="viewcode-block" id="CmdWield.parse">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdWield.parse">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;What do you want to wield?&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">InterruptCommand</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span></div>


<div class="viewcode-block" id="CmdWield.func">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.CmdWield.func">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="n">candidates</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="o">.</span><span class="n">equipment</span><span class="o">.</span><span class="n">get_wieldable_objects_from_backpack</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s2">&quot;(You must carry the item to wield it.)&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">combathandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_or_create_combathandler</span><span class="p">()</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">queue_action</span><span class="p">({</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;wield&quot;</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
        <span class="n">combathandler</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$You() reach for </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">get_display_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caller</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TwitchCombatCmdSet">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.TwitchCombatCmdSet">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TwitchCombatCmdSet</span><span class="p">(</span><span class="n">CmdSet</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add to character, to be able to attack others in a twitch-style way.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;twitch_combat_cmdset&quot;</span>

<div class="viewcode-block" id="TwitchCombatCmdSet.at_cmdset_creation">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.TwitchCombatCmdSet.at_cmdset_creation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">at_cmdset_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdAttack</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdHold</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdStunt</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdUseItem</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdWield</span><span class="p">())</span></div>
</div>



<div class="viewcode-block" id="TwitchLookCmdSet">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.TwitchLookCmdSet">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TwitchLookCmdSet</span><span class="p">(</span><span class="n">CmdSet</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This will be added/removed dynamically when in combat.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;twitch_look_cmdset&quot;</span>

<div class="viewcode-block" id="TwitchLookCmdSet.at_cmdset_creation">
<a class="viewcode-back" href="../../../../../api/evennia.contrib.tutorials.evadventure.combat_twitch.html#evennia.contrib.tutorials.evadventure.combat_twitch.TwitchLookCmdSet.at_cmdset_creation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">at_cmdset_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">CmdLook</span><span class="p">())</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../../index.html">
              <img class="logo" src="../../../../../_static/evennia_logo.png" alt="Logo of Evennia"/>
            </a></p>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Links</h3>
<ul>
  <li><a href="https://www.evennia.com/docs/latest/index.html">Documentation Top</a> </li>
  <li><a href="https://www.evennia.com">Evennia Home</a> </li>
  <li><a href="https://github.com/evennia/evennia">Github</a> </li>
  <li><a href="http://games.evennia.com">Game Index</a> </li>
  <li>
    <a href="https://discord.gg/AJJpcRUhtF">Discord</a> -
     <a href="https://github.com/evennia/evennia/discussions">Discussions</a> -
      <a href="https://evennia.blogspot.com/">Blog</a>
  </li>
</ul>
<h3>Doc Versions</h3>
<ul>
  
    <li>
      <a href="https://www.evennia.com/docs/latest/index.html">latest (main branch)</a>
    </li>
  
  
    <li>
      <a href="https://www.evennia.com/docs/5.x/index.html">v5.0.0 branch (outdated)</a>
    </li>
  
    <li>
      <a href="https://www.evennia.com/docs/4.x/index.html">v4.0.0 branch (outdated)</a>
    </li>
  
    <li>
      <a href="https://www.evennia.com/docs/3.x/index.html">v3.0.0 branch (outdated)</a>
    </li>
  
    <li>
      <a href="https://www.evennia.com/docs/2.x/index.html">v2.0.0 branch (outdated)</a>
    </li>
  
    <li>
      <a href="https://www.evennia.com/docs/1.x/index.html">v1.0.0 branch (outdated)</a>
    </li>
  
    <li>
      <a href="https://www.evennia.com/docs/0.x/index.html">v0.9.5 branch (outdated)</a>
    </li>
  
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Evennia</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../../evennia.html" >evennia</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">evennia.contrib.tutorials.evadventure.combat_twitch</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, The Evennia developer community.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>